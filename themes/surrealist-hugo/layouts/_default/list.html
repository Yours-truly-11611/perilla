{{ define "main" }}
<main class="site-content">
  <div class="container">
    <header class="list-header">
      <h1 class="list-header__title">{{ .Title }}</h1>
    </header>

    <div class="post-grid">
      {{ range .Pages }}
        <a href="{{ .Permalink }}" class="post-card" data-reveal>
          {{ with .Params.image }}
            <div class="post-card__image">
              <img src="{{ . }}" alt="{{ $.Title }}" loading="lazy" />
            </div>
          {{ end }}
          <div class="post-card__body">
            <time class="post-card__date" datetime="{{ .Date.Format "2006-01-02" }}">
              {{ .Date.Format "January 2, 2006" }}
            </time>
            <h2 class="post-card__title">{{ .Title }}</h2>
            {{ with .Summary }}
              <p class="post-card__summary">{{ . }}</p>
            {{ end }}
          </div>
        </a>
      {{ end }}
    </div>
  </div>
</main>

<script>
(function () {
  var cards = document.querySelectorAll('[data-reveal]');
  if (!cards.length) return;

  var observer = new IntersectionObserver(function (entries) {
    entries.forEach(function (entry) {
      if (entry.isIntersecting) {
        entry.target.classList.add('is-visible');
        observer.unobserve(entry.target);
      }
    });
  }, { threshold: 0.1 });

  cards.forEach(function (card) {
    observer.observe(card);
  });
})();
</script>
{{ end }}
